<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bibliotech ‚Äî Troca de Livros</title>
<style>
  :root{
    --bg:#f7f0e6; --accent:#c7a47c; --accent-2:#d7b894;
    --text:#4a3426; --card:#ffffff; --btn:#8c6f54;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text)}
  header{background:var(--accent-2);padding:18px;text-align:center;font-size:22px;font-weight:700}
  .wrap{max-width:900px;margin:0 auto;padding:16px}
  nav{display:flex;gap:10px;justify-content:center;margin:12px 0;flex-wrap:wrap}
  nav button{background:transparent;border:0;padding:8px 12px;border-radius:8px;font-weight:600;cursor:pointer}
  nav button.active{background:var(--accent)}
  .page{display:none}
  .page.active{display:block}
  .card{background:white;padding:14px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1);margin:10px 0;display:flex;gap:12px}
  .book-img{width:90px;height:130px;border-radius:6px;background-size:cover;background-position:center}
  h2{margin:0 0 10px 0}
  .small{color:#6d5a45;font-size:14px}
  .btn{background:var(--btn);color:white;border:0;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:600}
  .search{width:100%;padding:10px;border-radius:8px;border:1px solid #bcae9f;margin-top:8px}
</style>
</head>
<body>
<header>üìö Bibliotech ‚Äî Trocas de Livros</header>

<div class="wrap">
<nav id="menu">
  <button class="active" data-page="home">In√≠cio</button>
  <button data-page="estante">Estante</button>
  <button data-page="buscar">Buscar</button>
  <button data-page="troca">Solicitar Troca</button>
  <button data-page="chat">Chat</button>
</nav>
<!-- P√ÅGINA IN√çCIO -->
<section id="home" class="page active">
  <h2>Como funciona a Bibliotech?</h2>
  <p class="small">
    A Bibliotech permite ver livros dispon√≠veis, favoritar, buscar t√≠tulos,
    solicitar trocas e conversar com o respons√°vel.
  </p>
  <div class="card">
    <div style="flex:1">
      <strong>Funcionalidades principais:</strong>
      <ul style="margin:6px 0 0 18px">
        <li>Estante virtual</li>
        <li>Buscar livros</li>
        <li>Adicionar aos favoritos</li>
        <li>Solicitar troca</li>
        <li>Chat interativo</li>
      </ul>
    </div>
  </div>
</section>

<!-- ESTANTE -->
<section id="estante" class="page">
  <h2>Estante ‚Äî Livros dispon√≠veis</h2>

  <div id="shelf"></div>
</section>
<!-- BUSCAR -->
<section id="buscar" class="page">
  <h2>Buscar Livros</h2>
  <input id="searchInput" class="search" placeholder="Digite o t√≠tulo..." oninput="searchBooks()">
  <div id="searchResults"></div>
</section>

<!-- SOLICITAR TROCA -->
<section id="troca" class="page">
  <h2>Solicitar Troca</h2>
  <p class="small">Os livros que voc√™ favoritar aparecer√£o aqui.</p>
  <div id="favoritosBox"></div>
  <div id="trocaBox" style="margin-top:12px"></div>
</section>

<!-- CHAT -->
<section id="chat" class="page">
  <h2>Chat com o respons√°vel</h2>
  <div id="chat-box"
       style="background:white;border-radius:8px;padding:10px;height:260px;overflow:auto;box-shadow:0 2px 6px rgba(0,0,0,.1)">
  </div>

  <input id="chatInput" class="search"
         placeholder="Digite sua mensagem e pressione Enter"
         onkeypress="handleChat(event)">
</section>

<!-- MODAL DE DETALHES -->
<div id="modal"
     style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);align-items:center;justify-content:center;">
  <div style="background:white;padding:16px;border-radius:10px;max-width:90%;"
       id="modalContent"></div>
</div>
<script>
// Lista de livros
const livros = [
  {id:1,titulo:"Harry Potter e a Pedra Filosofal",autor:"J.K. Rowling",capa:"https://m.media-amazon.com/images/I/81iqZ2HHD-L.jpg",resumo:"O come√ßo da jornada do jovem bruxo."},
  {id:2,titulo:"O Pequeno Pr√≠ncipe",autor:"Antoine de Saint-Exup√©ry",capa:"https://m.media-amazon.com/images/I/71aFt4+OTOL.jpg",resumo:"Um cl√°ssico sobre amizade e inoc√™ncia."},
  {id:3,titulo:"Dom Casmurro",autor:"Machado de Assis",capa:"https://m.media-amazon.com/images/I/81OthjkJBuL.jpg",resumo:"Uma hist√≥ria marcada pela d√∫vida e ci√∫me."},
  {id:4,titulo:"O Hobbit",autor:"J.R.R. Tolkien",capa:"https://m.media-amazon.com/images/I/81WcnNQ-TBL.jpg",resumo:"A aventura inesperada de Bilbo Bolseiro."},
  {id:5,titulo:"A Culpa √© das Estrelas",autor:"John Green",capa:"https://m.media-amazon.com/images/I/71g2ednj0JL.jpg",resumo:"Um romance emocionante sobre amor e perda."}
];

// Mudar p√°ginas
document.querySelectorAll("#menu button").forEach(btn=>{
  btn.onclick = ()=>{
    document.querySelectorAll("#menu button").forEach(x=>x.classList.remove("active"));
    btn.classList.add("active");
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    document.getElementById(btn.dataset.page).classList.add("active");
  };
});

// Criar estante de livros
function renderShelf(){
  const shelf = document.getElementById("shelf");
  shelf.innerHTML = "";
  livros.forEach(livro=>{
    shelf.innerHTML += `
      <div class="card">
        <div class="book-img" style="background-image:url('${livro.capa}')"></div>
        <div style="flex:1">
          <strong>${livro.titulo}</strong>
          <p class="small">${livro.autor}</p>
          <p class="small">${livro.resumo}</p>
          <button class="btn" onclick="openDetails(${livro.id})">Detalhes</button>
          <button class="btn" style="background:#c7a47c" onclick="addFavorite(${livro.id})">Favoritar ‚≠ê</button>
        </div>
      </div>
    `;
  });
}

// Abrir detalhes em modal
function openDetails(id){
  const livro = livros.find(l=>l.id===id);
  document.getElementById("modalContent").innerHTML = `
    <h3>${livro.titulo}</h3>
    <p><em>${livro.autor}</em></p>
    <div class="book-img" style="width:120px;height:165px;background-image:url('${livro.capa}')"></div>
    <p class="small">${livro.resumo}</p>
    <button class="btn" onclick="addFavorite(${livro.id})">Favoritar ‚≠ê</button>
  `;
  document.getElementById("modal").style.display="flex";
}

// Fechar modal ao clicar fora
document.getElementById("modal").onclick = (e)=>{
  if(e.target.id==="modal") e.target.style.display="none";
};

// Favoritos
function getFavs(){ return JSON.parse(localStorage.getItem("favs")||"[]"); }
function saveFavs(arr){ localStorage.setItem("favs",JSON.stringify(arr)); }

function addFavorite(id){
  let favs = getFavs();
  if(!favs.includes(id)){
    favs.push(id);
    saveFavs(favs);
    alert("Livro adicionado aos favoritos!");
    renderFavorites();
  } else {
    alert("Esse livro j√° est√° nos favoritos.");
  }
}

// Renderizar favoritos
function renderFavorites(){
  const favs = getFavs();
  const box = document.getElementById("favoritosBox");
  box.innerHTML = "";
  if(favs.length===0){
    box.innerHTML = "<p class='small'>Nenhum favorito ainda.</p>";
    return;
  }
  favs.forEach(fid=>{
    const l = livros.find(x=>x.id===fid);
    box.innerHTML += `
      <div class="card">
        <div class="book-img" style="background-image:url('${l.capa}')"></div>
        <div>
          <strong>${l.titulo}</strong>
          <p class="small">${l.autor}</p>
          <button class="btn" onclick="selectTroca(${l.id})">Solicitar troca</button>
        </div>
      </div>
    `;
  });
}

// Solicitar troca
let livroSelecionado = null;

function selectTroca(id){
  livroSelecionado = livros.find(l=>l.id===id);
  document.getElementById("trocaBox").innerHTML = `
    <div class="card">
      <div style="flex:1">
        <strong>Voc√™ quer trocar por:</strong>
        <p>${livroSelecionado.titulo}</p>
        <button class="btn" onclick="confirmTroca()">Confirmar Solicita√ß√£o</button>
      </div>
    </div>
  `;
}

// Confirmar solicita√ß√£o e abrir chat
function confirmTroca(){
  document.getElementById("trocaBox").innerHTML =
    "<p>‚úî Solicita√ß√£o enviada! O respons√°vel vai falar com voc√™ no chat.</p>";
  document.getElementById("menu").querySelector("[data-page='chat']").click();

  setTimeout(()=>addMessage("Respons√°vel: Oi! Recebi sua solicita√ß√£o üòä"),800);
  setTimeout(()=>addMessage(`Respons√°vel: Meu livro √© '${livroSelecionado.titulo}'.`),1500);
  setTimeout(()=>addMessage("Respons√°vel: Qual livro voc√™ tem para trocar?"),2200);
}

// CHAT
function addMessage(text){
  const box = document.getElementById("chat-box");
  box.innerHTML += `<div class="msg">${text}</div>`;
  box.scrollTop = box.scrollHeight;
}

function handleChat(e){ if(e.key==="Enter") sendMessage(); }

function sendMessage(){
  const input = document.getElementById("chatInput");
  const msg = input.value.trim();
  if(!msg) return;
  addMessage("Voc√™: " + msg);
  input.value = "";

  setTimeout(()=>{
    addMessage("Respons√°vel: Entendi! Vamos combinar a troca?");
  },800);
}

// Buscar
function searchBooks(){
  const txt = document.getElementById("searchInput").value.toLowerCase();
  const box = document.getElementById("searchResults");
  box.innerHTML = "";

  const resultado = livros.filter(l=>
    l.titulo.toLowerCase().includes(txt) ||
    l.autor.toLowerCase().includes(txt)
  );

  resultado.forEach(l=>{
    box.innerHTML += `
      <div class="card">
        <div class="book-img" style="background-image:url('${l.capa}')"></div>
        <div>
          <strong>${l.titulo}</strong>
          <p class="small">${l.autor}</p>
          <button class="btn" onclick="openDetails(${l.id})">Ver detalhes</button>
        </div>
      </div>
    `;
  });

  if(resultado.length===0){
    box.innerHTML = "<p class='small'>Nenhum livro encontrado.</p>";
  }
}

// Inicializar p√°ginas
renderShelf();
renderFavorites();
</script>
</body>
</html>
<!-- vers√£o atualizada: 2 -->
